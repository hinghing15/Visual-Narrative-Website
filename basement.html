<!-- !!!!!!!!!!!!!!!!!WARNING!!!!!!!!!!!!!!!!!!!!! -->
<!-- This is the framework file, if you want to create a new room, make COPY of this file! -->
<!-- DO NOT EDIT THIS. ONLY MAKE COPIES OF IT. -->
<!-- Be sure to delete this warning on any copies you make -->

<!DOCTYPE html>
<html>
<head>
	<title>&lrm;</title> <link rel="icon" href="favicon.ico" />
	<link rel="stylesheet" type="text/css" href="resources/style.css"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script src="resources/script.js"></script>
	<audio id="dooropen" src="sounds/DoorOpen.mp3" onended="leaveRoom()"></audio>
	<script>

	function leaveRoom() {
		location.href='basement_hallway.html';
		// put the following code where you would normally say to leave
		// document.getElementById("dooropen").play();
	}

	$(document).ready(function(){

		// change this to change the background image
		// the dimensions should be 720px X 405px.
		// ======================
			picture_set("rooms/basement.png");
			background_set("#000000");
			border_set("#ffffff");
		// ======================

		var loopingviolins = new Sound('sounds/ScaryViolins.mp3');
		loopingviolins.setVolume(0.2);
		loopingviolins.playLooping();

		// clickers go HERE
		// =====================================================

			//SAFE CODE SAFE CODE SAFE CODE
			var password = [1, 1, 1, 1];
			//SAFE CODE SAFE CODE SAFE CODE

			var girl = document.createElement('div');
			$(girl).attr('id','girl');
			$('#clickers').append($(girl));

			function girl_stand(){
				$(girl).css({
						'background': 'url(clickers/GirlStanding.png)',
						'background-size': 'contain',
						'width': '75px',
						'height': '233px'
					});
			}

			// if(sessionStorage.beingChased == 0){
			// 	setTimeout(function(){
			// 		console.log('initiate phase one');
			// 		style_for_chase(1);
			// 		loopingviolins.setVolume(0.4);
			// 		loopingviolins.setRate(1.5);
			// 	}, 1000*15);

			// 	setTimeout(function(){
			// 		console.log('power up the bass cannon');
			// 		style_for_chase(2);
			// 		loopingviolins.setVolume(0.65);
			// 		loopingviolins.setRate(2.5);
			// 	}, 1000*30);

			// 	setTimeout(function(){
			// 		console.log('POWER UP THE BASS CANNON');
			// 		girl_stand();
			// 		loopingviolins.setVolume(1);
			// 		loopingviolins.setRate(4);
			// 	}, 1000*45);

			// 	setTimeout(function(){
			// 		lose("You died.");
			// 	}, 1000*48);
			// } else {
			// 	style_for_chase(2);
			// 	setTimeout(function(){
			// 		lose("You went back.");
			// 		girl_stand();
			// 	}, 1000*2.5);
			// }

			// --------------- code for the safe past this line.

			paintingMoved = false;

			var safex = 310;
			var safey = 140;

			var sc = new Sound('sounds/PasswordCorrect.mp3');
			var opensound = new Sound('sounds/SafeUnlock&Open.mp3');
			var paintsound = new Sound('sounds/DropPainting.mp3');

			function move_painting(){
					if(!paintingMoved){
						paintsound.play();
						paintingMoved = true;
					}
					$('#clicker_nobird').css({'top':'290px', 'left':'480px'});
			}

			function open_safe(){
				opensound.play();
				show_inline_view("clickers/SafeOpen.png", function(){
					add_inline_clicker(130,200,71,44,"clicker_exitkey","clickers/Key.png", function(){
						remove_clicker("clicker_safe");
						add_clicker(safex,safey,93,93,"clicker_safe_emptied","clickers/SafeOpen.png", null);
						inventory_add_item("Exit Key", "clickers/Key.png");
						remove_inline_clicker("clicker_exitkey");
						sessionStorage.beingChased = 1;
						style_for_chase(2);
						girl_stand();
						hide_inline_view();
						setTimeout(function(){
							lose("You were caught.");
						}, 1000*4);
					});
				});
			}

			if( !inventory_has_item("Exit Key") ) {
				add_clicker(safex,safey,93,93,"clicker_safe","clickers/SafeLocked.png",function(){
					show_inline_view("clickers/SafeLocked.png",function(){
						console.log("you clicked the SAFE. nice job");
						var corrects = 0;
						function click_pad(n){
							sc.play();
							if(n == password[corrects]){
								corrects++;
							} else {
								corrects = 0;
							}
							if(corrects == password.length){
								hide_inline_view();
								open_safe();
							}
						}
						var xp = 65;
						var yp = 70;
						var wp = 34;
						var hp = 35;
						add_inline_clicker(xp,		yp,   wp, hp, "num_1", "", function(){		click_pad(1); });
						add_inline_clicker(xp+wp,	yp,   wp, hp, "num_2", "", function(){		click_pad(2); });
						add_inline_clicker(xp+wp*2,	yp,	  wp, hp, "num_3", "", function(){		click_pad(3); });
						add_inline_clicker(xp,		yp+hp, wp, hp, "num_4", "", function(){		click_pad(4); });
						add_inline_clicker(xp+wp,	yp+hp, wp, hp, "num_5", "", function(){		click_pad(5); });
						add_inline_clicker(xp+wp*2,	yp+hp, wp, hp, "num_6", "", function(){		click_pad(6); });
						add_inline_clicker(xp,		yp+hp*2, wp, hp, "num_7", "", function(){	click_pad(7); });
						add_inline_clicker(xp+wp,	yp+hp*2, wp, hp, "num_8", "", function(){	click_pad(8); });
						add_inline_clicker(xp+wp*2,	yp+hp*2, wp, hp, "num_9", "", function(){	click_pad(9); });
					});
				});
			} else {
				add_clicker(safex,safey,93,93,"clicker_safe_emptied","clickers/SafeOpen.png", null);
			}

			add_clicker(safex,safey,93,93,"clicker_nobird","clickers/PaintingNoBird.png",function(){
				move_painting();
			});

			// ---------------------

			
		// =====================================================

		// set where clicking on the side links makes you go
			nav_left("");
			nav_right("basement_hallway.html");
			nav_up("");
			nav_down("");


	});
	</script>
	<script src="resources/postscript.js"></script>
</head>
<body>

<div class="inline-dismisser"></div>

<div id="wrapper">
	<div id="picture"></div>
	<div id="navclicks">
		<div class="navclick" id="click-up"></div>
		<div class="navclick" id="click-down"></div>
		<div class="navclick" id="click-left"></div>
		<div class="navclick" id="click-right"></div>
	</div>
	<div id="clickers">
		<!-- in here, there go all the custom clicky boxes for items and stuff -->
		<!-- this is handled with the javascript so DON'T PUT ANYTHING HERE. -->
		<!-- ================================================================= -->

		<!-- <div class="clicker" style="width:40px;height:40px;top:150px;left:400px;"></div> -->

		<!-- ================================================================= -->
	</div>
	<div class="inline-dismisser"></div>
	<div id="inline">
		<div id="inline-clickers">
			<!-- in here, go even more clickers for each inline view. -->
		</div>
	</div>
	<div id="inventory"></div>
	<div id="subtitle"></div>
</div>

</body>
</html>